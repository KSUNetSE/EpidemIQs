
# Repeat for another p_cc (example i=5, p_cc=0.3, intermediate core connectivity)
p_cc = 0.3  # index i=5
adj_csr = generate_core_periphery(N, N_core, N_periphery, p_cc, p_cp, p_pp)

# Core seeding (A)
save_path_A = os.path.join(os.getcwd(), 'output', 'results-51.csv')
df_A = run_ensemble(adj_csr, threshold, 'core', ensemble_size, systemic_thresh, save_path=save_path_A)
plt.figure(figsize=(6, 4))
plt.hist(df_A['n_final_failed'], bins=np.arange(0, N+2, 2), alpha=0.7, color='C0', label='Core shock')
plt.axvline(systemic_thresh, linestyle='--', color='k', label='systemic threshold')
plt.xlabel('Cascade size (final # failed)')
plt.ylabel('Frequency')
plt.title('Cascade size distribution (Core shock, p_cc = 0.3)')
plt.legend()
plt.tight_layout()
plt.savefig(os.path.join(os.getcwd(), 'output', 'results-51.png'))
plt.close()

# Periphery seeding (B)
save_path_B = os.path.join(os.getcwd(), 'output', 'results-52.csv')
df_B = run_ensemble(adj_csr, threshold, 'periphery', ensemble_size, systemic_thresh, save_path=save_path_B)
plt.figure(figsize=(6, 4))
plt.hist(df_B['n_final_failed'], bins=np.arange(0, N+2, 2), alpha=0.7, color='C1', label='Periphery shock')
plt.axvline(systemic_thresh, linestyle='--', color='k', label='systemic threshold')
plt.xlabel('Cascade size (final # failed)')
plt.ylabel('Frequency')
plt.title('Cascade size distribution (Periphery shock, p_cc = 0.3)')
plt.legend()
plt.tight_layout()
plt.savefig(os.path.join(os.getcwd(), 'output', 'results-52.png'))
plt.close()